# 网红旅行平台 - 后台系统产品需求文档

## 1. 行程管理模块需求

### 1.1 行程录入功能

后台系统需要提供完整的行程录入功能，运营人员通过此功能可创建和管理平台上的所有行程。基于对前端网红客户端的分析，后台行程管理系统需要包含以下核心功能：

#### 1.1.1 行程基本信息录入

- **行程ID**：系统自动生成的唯一标识符，方便管理和引用
- **行程标题**：行程的显示名称，需简洁明了地表达行程特点
- **行程目的地**：行程的主要目的地名称
- **行程日期**：行程开始的具体日期（格式：YYYY-MM-DD）
- **行程时长**：行程持续的天数（数字类型）
- **行程描述**：行程的详细介绍，支持富文本编辑
- **行程状态标签**：如"热门"、"限量"、"特惠"等，并可设置对应的显示文本
- **行程图片**：支持多张图片上传，用于行程展示

#### 1.1.2 行程详细信息录入

- **行程安排**：
  - 每天的活动时间
  - 活动名称
  - 活动描述
- **行程亮点**：行程的特色和亮点，以列表形式呈现
- **报名要求**：对网红的要求，如粉丝数量、内容类型等
- **费用包含项目**：行程费用中包含的服务和项目
- **费用不包含项目**：行程费用中不包含的服务和项目

#### 1.1.3 佣金信息录入

- **基础佣金**：网红可获得的基本佣金金额
- **额外奖励**：根据表现可获得的额外奖励金额
- **总佣金**：基础佣金与额外奖励的总和
- **佣金规则**：佣金计算和发放的规则说明

#### 1.1.4 参与者信息设置

- **最大参与人数**：行程可接受的最大网红数量
- **最小成团人数**：行程确认成团所需的最小网红数量
- **报名截止日期**：网红报名的截止日期（格式：YYYY-MM-DD）

#### 1.1.5 行程归属与责任方设置

- **行程归属标记**：明确指定当前行程是由平台承担还是由旅行社承担
- **旅行社信息**（若适用）：
  - 旅行社名称
  - 旅行社联系方式
  - 旅行社资质证明
- **平台负责人**（若由平台承担）：
  - 负责人姓名
  - 联系方式
  - 部门信息

### 1.2 行程生效机制

为确保行程质量和内容审核，系统需实现行程生效机制：

1. **默认状态**：新创建的行程默认为"未生效"状态
2. **生效操作**：运营人员需点击"生效"按钮，将行程状态切换为"已生效"
3. **生效条件检查**：
   - 所有必填字段已完成
   - 行程图片已上传
   - 行程安排已完整填写
   - 佣金信息已设置
4. **生效后规则**：
   - 只有"已生效"的行程才会在网红端展示
   - 已生效的行程部分字段锁定不可编辑（如行程ID、日期等）
   - 可通过"取消生效"操作将行程重新设为"未生效"状态

### 1.3 行程复制功能

为提高运营效率，系统需提供行程复制功能：

1. **复制操作**：运营人员可对任意行程（无论是否生效）点击"复制行程"按钮
2. **复制规则**：
   - 系统自动生成新的行程ID
   - 复制原行程的所有内容（包括标题、描述、行程安排等）
   - 新行程标题默认添加"副本"标记，如"珠海长隆海洋王国亲子2日游（副本）"
   - 新行程默认为"未生效"状态
3. **编辑复制行程**：
   - 运营人员可对复制的行程进行所有字段的修改
   - 必须重新设置行程日期和报名截止日期
   - 修改完成后，需要点击"生效"按钮使行程生效并展示给网红

## 2. 行程数据结构设计

基于前端网红客户端的需求，后台行程数据结构应包含以下字段：

```javascript
{
  // 基本信息
  id: String,                   // 行程ID，系统自动生成
  title: String,                // 行程标题
  destination: String,          // 目的地
  date: String,                 // 开始日期 (YYYY-MM-DD)
  duration: Number,             // 行程天数
  description: String,          // 行程描述 (富文本)
  
  // 图片
  images: Array,                // 行程图片列表
  
  // 佣金信息
  baseCommission: String,       // 基础佣金
  bonusCommission: String,      // 额外奖励
  totalCommission: String,      // 总佣金
  commissionRules: Array,       // 佣金规则列表
  
  // 行程详情
  schedule: Array,              // 行程安排列表
  requirements: Array,          // 报名要求列表
  highlights: Array,            // 行程亮点列表
  inclusions: Array,            // 费用包含项目列表
  exclusions: Array,            // 费用不包含项目列表
  
  // 参与者信息
  currentParticipants: Number,  // 当前参与人数
  maxParticipants: Number,      // 最大参与人数
  minParticipants: Number,      // 最小成团人数
  enrollmentDeadline: String,   // 报名截止日期
  
  // 状态信息
  status: {                     // 行程状态
    type: String,               // 状态类型 (hot、limited、promotion等)
    text: String                // 状态文本
  },
  isFull: Boolean,              // 是否已满员
  isConfirmed: Boolean,         // 是否已确认成团
  hasInfluencer: Boolean,       // 是否已有网红报名
  
  // 行程归属信息
  ownerType: String,            // 归属类型：'platform'或'agency'
  
  // 旅行社信息（如适用）
  agency: {
    name: String,               // 旅行社名称
    contact: String,            // 联系方式
    license: String,            // 资质证明
    address: String             // 地址
  },
  
  // 平台负责信息（如适用）
  platformOwner: {
    name: String,               // 负责人姓名
    contact: String,            // 联系方式
    department: String          // 部门
  },
  
  // 系统管理字段
  isActive: Boolean,            // 是否生效
  createdAt: String,            // 创建时间
  updatedAt: String,            // 最后更新时间
  createdBy: String,            // 创建者ID
  lastUpdatedBy: String         // 最后更新者ID
}
```

## 3. 行程管理页面功能

### 3.1 行程列表页

- **筛选功能**：
  - 按状态筛选：全部、已生效、未生效
  - 按归属筛选：全部、平台承担、旅行社承担
  - 按时间筛选：未开始、进行中、已结束
  - 按目的地筛选
  - 按行程ID或标题搜索

- **列表展示内容**：
  - 行程ID
  - 行程标题
  - 目的地
  - 开始日期
  - 行程时长
  - 当前/最大参与人数
  - 报名截止日期
  - 生效状态
  - 归属信息
  - 操作按钮

- **操作功能**：
  - 查看详情
  - 编辑行程
  - 生效/取消生效
  - 复制行程
  - 删除行程（未生效状态可删除）

### 3.2 行程创建/编辑页

- **表单布局**：
  - 分为基本信息、详细信息、佣金设置、参与者设置、归属设置等模块
  - 采用分步表单或标签页形式，减轻填写负担

- **预览功能**：
  - 实时预览行程在网红端的展示效果
  - 模拟网红端行程详情页面布局

- **保存机制**：
  - 自动保存草稿
  - 表单验证提示
  - 提交保存并返回列表
  - 提交并生效（满足条件时）

## 4. 行程归属与展示规则

### 4.1 行程归属标记规则

1. **必选设置**：每个行程必须明确设置归属方（平台或旅行社）
2. **默认值**：新创建行程默认归属为"平台承担"
3. **展示逻辑**：
   - 在网红端，若行程有旅行社信息且设置为显示，则在行程详情中展示旅行社信息
   - 若无旅行社信息或设置为不显示，则不在网红端展示归属信息

### 4.2 展示规则控制

1. **旅行社信息展示控制**：
   - 提供"是否在网红端展示旅行社信息"的开关选项
   - 默认设置为"展示"
   - 仅当行程归属为"旅行社承担"时此选项有效

2. **平台信息展示**：
   - 平台负责行程不在网红端展示具体负责人信息
   - 仅在后台系统中记录负责人信息，用于内部管理

## 5. 总结

后台行程管理系统需要提供全面的行程创建、编辑、管理功能，确保行程数据的完整性和准确性。通过行程生效机制和复制功能，提高运营效率。同时，行程归属标记功能使平台能够清晰区分责任方，并根据需要控制信息展示。

最终目标是建立一个高效、清晰的行程管理系统，支持前端网红客户端的所有功能需求，同时为运营团队提供便捷的管理工具。
