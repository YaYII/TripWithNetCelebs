# çº¦æ—…å¹³å°APIæ¥å£æ–‡æ¡£

**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¶é—´**: 2024å¹´  
**æ–‡æ¡£è¯´æ˜**: çº¦æ—…å¹³å°å‰åç«¯APIæ¥å£å¯¹æ¥æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [1. æ¥å£æ¦‚è¿°](#1-æ¥å£æ¦‚è¿°)
- [2. è®¤è¯æœºåˆ¶](#2-è®¤è¯æœºåˆ¶)
- [3. é€šç”¨è§„èŒƒ](#3-é€šç”¨è§„èŒƒ)
- [4. ç”¨æˆ·ç®¡ç†æ¥å£](#4-ç”¨æˆ·ç®¡ç†æ¥å£)
- [5. ç½‘çº¢ç®¡ç†æ¥å£](#5-ç½‘çº¢ç®¡ç†æ¥å£)
- [6. æ—…è¡ŒæœåŠ¡æ¥å£](#6-æ—…è¡ŒæœåŠ¡æ¥å£)
- [7. è®¢å•ç®¡ç†æ¥å£](#7-è®¢å•ç®¡ç†æ¥å£)
- [8. æ”¯ä»˜æ¥å£](#8-æ”¯ä»˜æ¥å£)
- [9. è¯„ä»·ç³»ç»Ÿæ¥å£](#9-è¯„ä»·ç³»ç»Ÿæ¥å£)
- [10. æ¶ˆæ¯é€šçŸ¥æ¥å£](#10-æ¶ˆæ¯é€šçŸ¥æ¥å£)
- [11. æ•°æ®ç»Ÿè®¡æ¥å£](#11-æ•°æ®ç»Ÿè®¡æ¥å£)
- [12. é”™è¯¯ç è¯´æ˜](#12-é”™è¯¯ç è¯´æ˜)

## 1. æ¥å£æ¦‚è¿°

### 1.1 åŸºç¡€ä¿¡æ¯
- **åŸºç¡€URL**: `https://api.yuelu.com`
- **åè®®**: HTTPS
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8
- **è¯·æ±‚æ–¹å¼**: GETã€POSTã€PUTã€DELETE

### 1.2 ç¯å¢ƒè¯´æ˜
```javascript
// å¼€å‘ç¯å¢ƒ
const DEV_BASE_URL = 'https://dev-api.yuelu.com';

// æµ‹è¯•ç¯å¢ƒ
const TEST_BASE_URL = 'https://test-api.yuelu.com';

// ç”Ÿäº§ç¯å¢ƒ
const PROD_BASE_URL = 'https://api.yuelu.com';
```

## 2. è®¤è¯æœºåˆ¶

### 2.1 JWT Tokenè®¤è¯

**è¯·æ±‚å¤´æ ¼å¼**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| Authorization | string | æ˜¯ | Bearer Tokenæ ¼å¼ | "Bearer {access_token}" |
| Content-Type | string | æ˜¯ | å†…å®¹ç±»å‹ | "application/json" |

```javascript
// è¯·æ±‚å¤´æ ¼å¼
{
  "Authorization": "Bearer {access_token}",
  "Content-Type": "application/json"
}
```

### 2.2 Tokenè·å–

**æ¥å£åœ°å€**: `POST /api/v1/auth/login`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| phone | string | æ˜¯ | æ‰‹æœºå·ç ï¼Œ11ä½æ•°å­— | "13800138000" |
| password | string | æ˜¯ | å¯†ç ï¼Œ6-20ä½å­—ç¬¦ | "123456" |
| type | string | æ˜¯ | ç”¨æˆ·ç±»å‹ï¼šuser-æ™®é€šç”¨æˆ·ï¼Œcelebrity-ç½‘çº¢ï¼Œadmin-ç®¡ç†å‘˜ | "user" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
// ç™»å½•è·å–Token
POST /api/v1/auth/login
{
  "phone": "13800138000",
  "password": "123456",
  "type": "user"
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | ç™»å½•ç»“æœå¯¹è±¡ |
| data.access_token | string | è®¿é—®ä»¤ç‰Œï¼Œæœ‰æ•ˆæœŸ7å¤© |
| data.refresh_token | string | åˆ·æ–°ä»¤ç‰Œï¼Œç”¨äºè·å–æ–°çš„è®¿é—®ä»¤ç‰Œ |
| data.expires_in | integer | è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰ |
| data.user_info | object | ç”¨æˆ·ä¿¡æ¯å¯¹è±¡ |
| data.user_info.id | integer | ç”¨æˆ·ID |
| data.user_info.phone | string | æ‰‹æœºå·ç  |
| data.user_info.nickname | string | ç”¨æˆ·æ˜µç§° |
| data.user_info.avatar | string | ç”¨æˆ·å¤´åƒURL |
| data.user_info.type | string | ç”¨æˆ·ç±»å‹ |

**å“åº”ç¤ºä¾‹**:
```javascript
// å“åº”
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 7200,
    "user_info": {
      "id": 1001,
      "phone": "13800138000",
      "nickname": "æ—…è¡Œè¾¾äºº",
      "avatar": "https://cdn.yuelu.com/avatar/1001.jpg",
      "type": "user"
    }
  }
}
```

### 2.3 å¾®ä¿¡ç™»å½•

**æ¥å£åœ°å€**: `POST /api/v1/auth/wx-login`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| code | string | æ˜¯ | å¾®ä¿¡ç™»å½•ä¸´æ—¶å‡­è¯ | "wx_login_code_here" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "code": "wx_login_code_here"
}
```

**å“åº”å‚æ•°**: åŒæ™®é€šç™»å½•å“åº”æ ¼å¼

### 2.4 åˆ·æ–°Token

**æ¥å£åœ°å€**: `POST /api/v1/auth/refresh`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| refresh_token | string | æ˜¯ | åˆ·æ–°ä»¤ç‰Œ | "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**å“åº”å‚æ•°**: åŒç™»å½•å“åº”æ ¼å¼ï¼Œè¿”å›æ–°çš„access_token

## 3. é€šç”¨è§„èŒƒ

### 3.1 å“åº”æ ¼å¼
```javascript
// æˆåŠŸå“åº”
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {}, // å…·ä½“æ•°æ®
  "timestamp": 1640995200000
}

// é”™è¯¯å“åº”
{
  "code": 400,
  "message": "å‚æ•°é”™è¯¯",
  "error": "phoneå­—æ®µä¸èƒ½ä¸ºç©º",
  "timestamp": 1640995200000
}
```

### 3.2 åˆ†é¡µæ ¼å¼
```javascript
// åˆ†é¡µè¯·æ±‚å‚æ•°
{
  "page": 1,        // é¡µç ï¼Œä»1å¼€å§‹
  "page_size": 20,  // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100
  "sort": "created_at", // æ’åºå­—æ®µ
  "order": "desc"   // æ’åºæ–¹å‘ï¼šasc/desc
}

// åˆ†é¡µå“åº”æ ¼å¼
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [],     // æ•°æ®åˆ—è¡¨
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 100,
      "total_pages": 5,
      "has_next": true,
      "has_prev": false
    }
  }
}
```

## 4. ç”¨æˆ·ç®¡ç†æ¥å£

### 4.1 ç”¨æˆ·æ³¨å†Œ

**æ¥å£åœ°å€**: `POST /api/v1/users/register`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| phone | string | æ˜¯ | æ‰‹æœºå·ç ï¼Œ11ä½æ•°å­— | "13800138000" |
| password | string | æ˜¯ | å¯†ç ï¼Œ6-20ä½å­—ç¬¦ | "123456" |
| sms_code | string | æ˜¯ | çŸ­ä¿¡éªŒè¯ç ï¼Œ6ä½æ•°å­— | "123456" |
| nickname | string | æ˜¯ | ç”¨æˆ·æ˜µç§°ï¼Œ2-20ä¸ªå­—ç¬¦ | "æ—…è¡Œè¾¾äºº" |
| avatar | string | å¦ | å¤´åƒURLåœ°å€ | "https://cdn.yuelu.com/avatar/default.jpg" |
| gender | integer | å¦ | æ€§åˆ«ï¼š0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³ | 1 |
| birthday | string | å¦ | ç”Ÿæ—¥ï¼Œæ ¼å¼ï¼šYYYY-MM-DD | "1990-01-01" |
| city | string | å¦ | æ‰€åœ¨åŸå¸‚ | "åŒ—äº¬å¸‚" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "phone": "13800138000",
  "password": "123456",
  "sms_code": "123456",
  "nickname": "æ—…è¡Œè¾¾äºº",
  "avatar": "https://cdn.yuelu.com/avatar/default.jpg",
  "gender": 1,
  "birthday": "1990-01-01",
  "city": "åŒ—äº¬å¸‚"
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.user_id | integer | ç”¨æˆ·ID |
| data.access_token | string | è®¿é—®ä»¤ç‰Œ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "user_id": 1001,
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

### 4.2 è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€**: `GET /api/v1/users/profile`

**è¯·æ±‚å‚æ•°**: æ— ï¼ˆéœ€è¦Tokenè®¤è¯ï¼‰

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | ç”¨æˆ·ä¿¡æ¯å¯¹è±¡ |
| data.id | integer | ç”¨æˆ·ID |
| data.phone | string | æ‰‹æœºå·ç  |
| data.nickname | string | ç”¨æˆ·æ˜µç§° |
| data.avatar | string | å¤´åƒURL |
| data.gender | integer | æ€§åˆ«ï¼š0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³ |
| data.birthday | string | ç”Ÿæ—¥ï¼Œæ ¼å¼ï¼šYYYY-MM-DD |
| data.city | string | æ‰€åœ¨åŸå¸‚ |
| data.level | integer | ç”¨æˆ·ç­‰çº§ |
| data.points | integer | ç§¯åˆ†ä½™é¢ |
| data.balance | number | è´¦æˆ·ä½™é¢ï¼ˆå…ƒï¼‰ |
| data.created_at | string | æ³¨å†Œæ—¶é—´ |
| data.updated_at | string | æœ€åæ›´æ–°æ—¶é—´ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "id": 1001,
    "phone": "13800138000",
    "nickname": "æ—…è¡Œè¾¾äºº",
    "avatar": "https://cdn.yuelu.com/avatar/1001.jpg",
    "gender": 1,
    "birthday": "1990-01-01",
    "city": "åŒ—äº¬å¸‚",
    "level": 2,
    "points": 1500,
    "balance": 299.50,
    "created_at": "2024-01-01 10:00:00",
    "updated_at": "2024-01-15 15:30:00"
  }
}
```

### 4.3 æ›´æ–°ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€**: `PUT /api/v1/users/profile`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| nickname | string | å¦ | ç”¨æˆ·æ˜µç§°ï¼Œ2-20ä¸ªå­—ç¬¦ | "æ–°æ˜µç§°" |
| avatar | string | å¦ | å¤´åƒURLåœ°å€ | "https://cdn.yuelu.com/avatar/new.jpg" |
| gender | integer | å¦ | æ€§åˆ«ï¼š0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³ | 2 |
| birthday | string | å¦ | ç”Ÿæ—¥ï¼Œæ ¼å¼ï¼šYYYY-MM-DD | "1992-05-15" |
| city | string | å¦ | æ‰€åœ¨åŸå¸‚ | "ä¸Šæµ·å¸‚" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "nickname": "æ–°æ˜µç§°",
  "avatar": "https://cdn.yuelu.com/avatar/new.jpg",
  "gender": 2,
  "birthday": "1992-05-15",
  "city": "ä¸Šæµ·å¸‚"
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.updated_fields | array | å·²æ›´æ–°çš„å­—æ®µåˆ—è¡¨ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "updated_fields": ["nickname", "avatar", "city"]
  }
}
```

### 4.4 å‘é€çŸ­ä¿¡éªŒè¯ç 

**æ¥å£åœ°å€**: `POST /api/v1/users/send-sms`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| phone | string | æ˜¯ | æ‰‹æœºå·ç ï¼Œ11ä½æ•°å­— | "13800138000" |
| type | string | æ˜¯ | éªŒè¯ç ç±»å‹ï¼šregister-æ³¨å†Œï¼Œlogin-ç™»å½•ï¼Œreset-é‡ç½®å¯†ç  | "register" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "phone": "13800138000",
  "type": "register"
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.expires_in | integer | éªŒè¯ç æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "éªŒè¯ç å‘é€æˆåŠŸ",
  "data": {
    "expires_in": 300
  }
}
```

## 5. ç½‘çº¢ç®¡ç†æ¥å£

### 5.1 ç½‘çº¢åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/v1/celebrities`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| page | integer | å¦ | é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤1 | 1 |
| page_size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 | 20 |
| city | string | å¦ | åŸå¸‚ç­›é€‰ | "åŒ—äº¬å¸‚" |
| category | string | å¦ | åˆ†ç±»ç­›é€‰ï¼šç¾é£Ÿã€æ™¯ç‚¹ã€è´­ç‰©ã€æ–‡åŒ– | "ç¾é£Ÿ" |
| price_min | integer | å¦ | æœ€ä½ä»·æ ¼ï¼ˆå…ƒ/å°æ—¶ï¼‰ | 100 |
| price_max | integer | å¦ | æœ€é«˜ä»·æ ¼ï¼ˆå…ƒ/å°æ—¶ï¼‰ | 1000 |
| sort | string | å¦ | æ’åºå­—æ®µï¼šrating-è¯„åˆ†ï¼Œprice-ä»·æ ¼ï¼Œpopularity-äººæ°” | "rating" |
| order | string | å¦ | æ’åºæ–¹å‘ï¼šasc-å‡åºï¼Œdesc-é™åº | "desc" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
GET /api/v1/celebrities?page=1&page_size=10&city=åŒ—äº¬å¸‚&category=ç¾é£Ÿ&sort=rating&order=desc
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.list | array | ç½‘çº¢åˆ—è¡¨ |
| data.list[].id | integer | ç½‘çº¢ID |
| data.list[].nickname | string | ç½‘çº¢æ˜µç§° |
| data.list[].avatar | string | å¤´åƒURL |
| data.list[].cover_image | string | å°é¢å›¾ç‰‡URL |
| data.list[].city | string | æ‰€åœ¨åŸå¸‚ |
| data.list[].category | array | æœåŠ¡åˆ†ç±»åˆ—è¡¨ |
| data.list[].description | string | ä¸ªäººç®€ä»‹ |
| data.list[].price_per_hour | number | æ¯å°æ—¶ä»·æ ¼ï¼ˆå…ƒï¼‰ |
| data.list[].rating | number | è¯„åˆ†ï¼ˆ1-5åˆ†ï¼‰ |
| data.list[].review_count | integer | è¯„ä»·æ•°é‡ |
| data.list[].order_count | integer | è®¢å•æ•°é‡ |
| data.list[].tags | array | æ ‡ç­¾åˆ—è¡¨ |
| data.list[].is_verified | boolean | æ˜¯å¦è®¤è¯ |
| data.list[].is_online | boolean | æ˜¯å¦åœ¨çº¿ |
| data.list[].response_rate | integer | å›å¤ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰ |
| data.list[].response_time | string | å¹³å‡å›å¤æ—¶é—´ |
| data.pagination | object | åˆ†é¡µä¿¡æ¯ |
| data.pagination.page | integer | å½“å‰é¡µç  |
| data.pagination.page_size | integer | æ¯é¡µæ•°é‡ |
| data.pagination.total | integer | æ€»è®°å½•æ•° |
| data.pagination.total_pages | integer | æ€»é¡µæ•° |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [
      {
        "id": 2001,
        "nickname": "åŒ—äº¬ç¾é£Ÿè¾¾äºº",
        "avatar": "https://cdn.yuelu.com/celebrity/2001.jpg",
        "cover_image": "https://cdn.yuelu.com/celebrity/cover/2001.jpg",
        "city": "åŒ—äº¬å¸‚",
        "category": ["ç¾é£Ÿ", "æ™¯ç‚¹"],
        "description": "ä¸“ä¸šç¾é£Ÿæ¢åº—ï¼Œå¸¦ä½ å‘ç°åŒ—äº¬éšè—ç¾å‘³",
        "price_per_hour": 299,
        "rating": 4.8,
        "review_count": 156,
        "order_count": 89,
        "tags": ["ç¾é£Ÿä¸“å®¶", "æœ¬åœ°å‘å¯¼", "æ‘„å½±è¾¾äºº"],
        "is_verified": true,
        "is_online": true,
        "response_rate": 95,
        "response_time": "5åˆ†é’Ÿå†…"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 50,
      "total_pages": 3
    }
  }
}
```

### 5.2 ç½‘çº¢è¯¦æƒ…

**æ¥å£åœ°å€**: `GET /api/v1/celebrities/{celebrity_id}`

**è·¯å¾„å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| celebrity_id | integer | æ˜¯ | ç½‘çº¢ID | 2001 |

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | ç½‘çº¢è¯¦æƒ…å¯¹è±¡ |
| data.id | integer | ç½‘çº¢ID |
| data.nickname | string | ç½‘çº¢æ˜µç§° |
| data.avatar | string | å¤´åƒURL |
| data.cover_image | string | å°é¢å›¾ç‰‡URL |
| data.city | string | æ‰€åœ¨åŸå¸‚ |
| data.category | array | æœåŠ¡åˆ†ç±»åˆ—è¡¨ |
| data.description | string | è¯¦ç»†ä»‹ç» |
| data.price_per_hour | number | æ¯å°æ—¶ä»·æ ¼ï¼ˆå…ƒï¼‰ |
| data.rating | number | è¯„åˆ†ï¼ˆ1-5åˆ†ï¼‰ |
| data.review_count | integer | è¯„ä»·æ•°é‡ |
| data.order_count | integer | è®¢å•æ•°é‡ |
| data.tags | array | æ ‡ç­¾åˆ—è¡¨ |
| data.is_verified | boolean | æ˜¯å¦è®¤è¯ |
| data.is_online | boolean | æ˜¯å¦åœ¨çº¿ |
| data.response_rate | integer | å›å¤ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰ |
| data.response_time | string | å¹³å‡å›å¤æ—¶é—´ |
| data.gallery | array | ç›¸å†Œå›¾ç‰‡URLåˆ—è¡¨ |
| data.services | array | æœåŠ¡é¡¹ç›®åˆ—è¡¨ |
| data.services[].id | integer | æœåŠ¡ID |
| data.services[].name | string | æœåŠ¡åç§° |
| data.services[].description | string | æœåŠ¡æè¿° |
| data.services[].duration | integer | æœåŠ¡æ—¶é•¿ï¼ˆå°æ—¶ï¼‰ |
| data.services[].price | number | æœåŠ¡ä»·æ ¼ï¼ˆå…ƒï¼‰ |
| data.services[].includes | array | åŒ…å«é¡¹ç›®åˆ—è¡¨ |
| data.schedule | object | å¯é¢„çº¦æ—¶é—´ï¼Œkeyä¸ºæ—¥æœŸï¼Œvalueä¸ºæ—¶é—´æ®µæ•°ç»„ |
| data.reviews | array | æœ€æ–°è¯„ä»·åˆ—è¡¨ |
| data.reviews[].id | integer | è¯„ä»·ID |
| data.reviews[].user_nickname | string | ç”¨æˆ·æ˜µç§° |
| data.reviews[].user_avatar | string | ç”¨æˆ·å¤´åƒ |
| data.reviews[].rating | integer | è¯„åˆ†ï¼ˆ1-5åˆ†ï¼‰ |
| data.reviews[].content | string | è¯„ä»·å†…å®¹ |
| data.reviews[].images | array | è¯„ä»·å›¾ç‰‡URLåˆ—è¡¨ |
| data.reviews[].created_at | string | è¯„ä»·æ—¶é—´ |

### 5.3 ç½‘çº¢æœåŠ¡é¡¹ç›®

**æ¥å£åœ°å€**: `GET /api/v1/celebrities/{celebrity_id}/services`

**è·¯å¾„å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| celebrity_id | integer | æ˜¯ | ç½‘çº¢ID | 2001 |

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.list | array | æœåŠ¡é¡¹ç›®åˆ—è¡¨ |
| data.list[].id | integer | æœåŠ¡ID |
| data.list[].name | string | æœåŠ¡åç§° |
| data.list[].description | string | æœåŠ¡æè¿° |
| data.list[].duration | integer | æœåŠ¡æ—¶é•¿ï¼ˆå°æ—¶ï¼‰ |
| data.list[].price | number | æœåŠ¡ä»·æ ¼ï¼ˆå…ƒï¼‰ |
| data.list[].original_price | number | åŸä»·ï¼ˆå…ƒï¼‰ |
| data.list[].discount | number | æŠ˜æ‰£ï¼ˆ0-1ä¹‹é—´ï¼‰ |
| data.list[].includes | array | åŒ…å«é¡¹ç›®åˆ—è¡¨ |
| data.list[].excludes | array | ä¸åŒ…å«é¡¹ç›®åˆ—è¡¨ |
| data.list[].max_people | integer | æœ€å¤§äººæ•° |
| data.list[].category | string | æœåŠ¡åˆ†ç±» |
| data.list[].difficulty | string | éš¾åº¦ç­‰çº§ï¼šç®€å•ã€ä¸­ç­‰ã€å›°éš¾ |
| data.list[].images | array | æœåŠ¡å›¾ç‰‡URLåˆ—è¡¨ |
| data.list[].itinerary | array | è¡Œç¨‹å®‰æ’åˆ—è¡¨ |
| data.list[].itinerary[].time | string | æ—¶é—´æ®µ |
| data.list[].itinerary[].location | string | åœ°ç‚¹ |
| data.list[].itinerary[].activity | string | æ´»åŠ¨å†…å®¹ |
| data.list[].itinerary[].description | string | æ´»åŠ¨æè¿° |
| data.list[].is_available | boolean | æ˜¯å¦å¯é¢„è®¢ |
| data.list[].booking_notice | string | é¢„è®¢é¡»çŸ¥ |

## 6. æ—…è¡ŒæœåŠ¡æ¥å£

### 6.1 åˆ›å»ºé¢„è®¢

**æ¥å£åœ°å€**: `POST /api/v1/bookings`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| celebrity_id | integer | æ˜¯ | ç½‘çº¢ID | 2001 |
| service_id | integer | æ˜¯ | æœåŠ¡é¡¹ç›®ID | 3001 |
| booking_date | string | æ˜¯ | é¢„è®¢æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD | "2024-01-25" |
| booking_time | string | æ˜¯ | é¢„è®¢æ—¶é—´æ®µï¼Œæ ¼å¼ï¼šHH:MM-HH:MM | "09:00-13:00" |
| people_count | integer | æ˜¯ | å‚ä¸äººæ•°ï¼Œæœ€å°1äºº | 2 |
| contact_name | string | æ˜¯ | è”ç³»äººå§“å | "å¼ ä¸‰" |
| contact_phone | string | æ˜¯ | è”ç³»äººæ‰‹æœºå· | "13800138000" |
| special_requirements | string | å¦ | ç‰¹æ®Šè¦æ±‚è¯´æ˜ | "å¸Œæœ›å¤šä»‹ç»ä¸€äº›å†å²æ–‡åŒ–" |
| coupon_id | integer | å¦ | ä¼˜æƒ åˆ¸ID | 5001 |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "celebrity_id": 2001,
  "service_id": 3001,
  "booking_date": "2024-01-25",
  "booking_time": "09:00-13:00",
  "people_count": 2,
  "contact_name": "å¼ ä¸‰",
  "contact_phone": "13800138000",
  "special_requirements": "å¸Œæœ›å¤šä»‹ç»ä¸€äº›å†å²æ–‡åŒ–",
  "coupon_id": 5001
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | é¢„è®¢ä¿¡æ¯å¯¹è±¡ |
| data.booking_id | string | é¢„è®¢å•å· |
| data.status | string | é¢„è®¢çŠ¶æ€ï¼špending_payment-å¾…æ”¯ä»˜ |
| data.total_amount | number | æ€»é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.discount_amount | number | ä¼˜æƒ é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.final_amount | number | æœ€ç»ˆæ”¯ä»˜é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.payment_deadline | string | æ”¯ä»˜æˆªæ­¢æ—¶é—´ |
| data.booking_details | object | é¢„è®¢è¯¦æƒ…å¯¹è±¡ |
| data.booking_details.celebrity_name | string | ç½‘çº¢å§“å |
| data.booking_details.service_name | string | æœåŠ¡åç§° |
| data.booking_details.booking_date | string | é¢„è®¢æ—¥æœŸ |
| data.booking_details.booking_time | string | é¢„è®¢æ—¶é—´ |
| data.booking_details.people_count | integer | å‚ä¸äººæ•° |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "é¢„è®¢æˆåŠŸ",
  "data": {
    "booking_id": "YL202401250001",
    "status": "pending_payment",
    "total_amount": 1198.00,
    "discount_amount": 100.00,
    "final_amount": 1098.00,
    "payment_deadline": "2024-01-20 18:00:00",
    "booking_details": {
      "celebrity_name": "åŒ—äº¬ç¾é£Ÿè¾¾äºº",
      "service_name": "ç¾é£Ÿæ¢åº—åŠæ—¥æ¸¸",
      "booking_date": "2024-01-25",
      "booking_time": "09:00-13:00",
      "people_count": 2
    }
  }
}
```

### 6.2 é¢„è®¢åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/v1/bookings`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| page | integer | å¦ | é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤1 | 1 |
| page_size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 | 20 |
| status | string | å¦ | çŠ¶æ€ç­›é€‰ï¼šall-å…¨éƒ¨ï¼Œpending_payment-å¾…æ”¯ä»˜ï¼Œconfirmed-å·²ç¡®è®¤ï¼Œin_progress-è¿›è¡Œä¸­ï¼Œcompleted-å·²å®Œæˆï¼Œcancelled-å·²å–æ¶ˆ | "all" |
| date_from | string | å¦ | å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD | "2024-01-01" |
| date_to | string | å¦ | ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD | "2024-01-31" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
GET /api/v1/bookings?page=1&page_size=20&status=all&date_from=2024-01-01&date_to=2024-01-31
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.list | array | é¢„è®¢åˆ—è¡¨ |
| data.list[].booking_id | string | é¢„è®¢å•å· |
| data.list[].status | string | é¢„è®¢çŠ¶æ€ |
| data.list[].status_text | string | çŠ¶æ€æ–‡æœ¬æè¿° |
| data.list[].celebrity_info | object | ç½‘çº¢ä¿¡æ¯å¯¹è±¡ |
| data.list[].celebrity_info.id | integer | ç½‘çº¢ID |
| data.list[].celebrity_info.nickname | string | ç½‘çº¢æ˜µç§° |
| data.list[].celebrity_info.avatar | string | ç½‘çº¢å¤´åƒ |
| data.list[].service_info | object | æœåŠ¡ä¿¡æ¯å¯¹è±¡ |
| data.list[].service_info.id | integer | æœåŠ¡ID |
| data.list[].service_info.name | string | æœåŠ¡åç§° |
| data.list[].service_info.image | string | æœåŠ¡å›¾ç‰‡ |
| data.list[].booking_date | string | é¢„è®¢æ—¥æœŸ |
| data.list[].booking_time | string | é¢„è®¢æ—¶é—´ |
| data.list[].people_count | integer | å‚ä¸äººæ•° |
| data.list[].total_amount | number | æ€»é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.list[].created_at | string | åˆ›å»ºæ—¶é—´ |
| data.list[].can_cancel | boolean | æ˜¯å¦å¯å–æ¶ˆ |
| data.list[].can_reschedule | boolean | æ˜¯å¦å¯æ”¹æœŸ |
| data.list[].can_review | boolean | æ˜¯å¦å¯è¯„ä»· |
| data.pagination | object | åˆ†é¡µä¿¡æ¯ |

### 6.3 é¢„è®¢è¯¦æƒ…

**æ¥å£åœ°å€**: `GET /api/v1/bookings/{booking_id}`

**è·¯å¾„å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| booking_id | string | æ˜¯ | é¢„è®¢å•å· | "YL202401250001" |

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | é¢„è®¢è¯¦æƒ…å¯¹è±¡ |
| data.booking_id | string | é¢„è®¢å•å· |
| data.status | string | é¢„è®¢çŠ¶æ€ |
| data.status_text | string | çŠ¶æ€æ–‡æœ¬æè¿° |
| data.celebrity_info | object | ç½‘çº¢ä¿¡æ¯ï¼ˆç¡®è®¤åæ˜¾ç¤ºè”ç³»æ–¹å¼ï¼‰ |
| data.celebrity_info.id | integer | ç½‘çº¢ID |
| data.celebrity_info.nickname | string | ç½‘çº¢æ˜µç§° |
| data.celebrity_info.avatar | string | ç½‘çº¢å¤´åƒ |
| data.celebrity_info.phone | string | ç½‘çº¢æ‰‹æœºå·ï¼ˆä»…ç¡®è®¤åæ˜¾ç¤ºï¼‰ |
| data.celebrity_info.wechat | string | ç½‘çº¢å¾®ä¿¡å·ï¼ˆä»…ç¡®è®¤åæ˜¾ç¤ºï¼‰ |
| data.service_info | object | æœåŠ¡ä¿¡æ¯å¯¹è±¡ |
| data.booking_details | object | é¢„è®¢è¯¦æƒ…å¯¹è±¡ |
| data.booking_details.booking_date | string | é¢„è®¢æ—¥æœŸ |
| data.booking_details.booking_time | string | é¢„è®¢æ—¶é—´ |
| data.booking_details.people_count | integer | å‚ä¸äººæ•° |
| data.booking_details.contact_name | string | è”ç³»äººå§“å |
| data.booking_details.contact_phone | string | è”ç³»äººæ‰‹æœº |
| data.booking_details.special_requirements | string | ç‰¹æ®Šè¦æ±‚ |
| data.booking_details.meeting_point | string | é›†åˆåœ°ç‚¹ |
| data.booking_details.meeting_time | string | é›†åˆæ—¶é—´ |
| data.payment_info | object | æ”¯ä»˜ä¿¡æ¯å¯¹è±¡ |
| data.payment_info.total_amount | number | æ€»é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.payment_info.discount_amount | number | ä¼˜æƒ é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.payment_info.final_amount | number | æœ€ç»ˆé‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.payment_info.payment_method | string | æ”¯ä»˜æ–¹å¼ |
| data.payment_info.payment_time | string | æ”¯ä»˜æ—¶é—´ |
| data.payment_info.transaction_id | string | äº¤æ˜“æµæ°´å· |
| data.timeline | array | è®¢å•æ—¶é—´çº¿ |
| data.timeline[].status | string | çŠ¶æ€ |
| data.timeline[].status_text | string | çŠ¶æ€æè¿° |
| data.timeline[].time | string | æ—¶é—´ |
| data.can_cancel | boolean | æ˜¯å¦å¯å–æ¶ˆ |
| data.can_reschedule | boolean | æ˜¯å¦å¯æ”¹æœŸ |
| data.can_review | boolean | æ˜¯å¦å¯è¯„ä»· |
| data.cancellation_policy | string | å–æ¶ˆæ”¿ç­–è¯´æ˜ |

## 7. è®¢å•ç®¡ç†æ¥å£

### 7.1 å–æ¶ˆé¢„è®¢
```javascript
POST /api/v1/bookings/{booking_id}/cancel

// è¯·æ±‚å‚æ•°
{
  "reason": "è¡Œç¨‹å˜æ›´", // å–æ¶ˆåŸå› 
  "description": "ä¸´æ—¶æœ‰äº‹æ— æ³•å‡ºè¡Œ" // è¯¦ç»†è¯´æ˜
}

// å“åº”
{
  "code": 200,
  "message": "å–æ¶ˆæˆåŠŸ",
  "data": {
    "refund_amount": 1098.00, // é€€æ¬¾é‡‘é¢
    "refund_method": "original", // é€€æ¬¾æ–¹å¼ï¼šoriginal(åŸè·¯é€€å›)ã€balance(ä½™é¢)
    "refund_time": "3-5ä¸ªå·¥ä½œæ—¥",
    "cancellation_fee": 0.00 // å–æ¶ˆæ‰‹ç»­è´¹
  }
}
```

### 7.2 æ”¹æœŸé¢„è®¢
```javascript
POST /api/v1/bookings/{booking_id}/reschedule

// è¯·æ±‚å‚æ•°
{
  "new_date": "2024-01-28",
  "new_time": "14:00-18:00",
  "reason": "æ—¶é—´å†²çª"
}

// å“åº”
{
  "code": 200,
  "message": "æ”¹æœŸç”³è¯·å·²æäº¤",
  "data": {
    "reschedule_id": "RS202401200001",
    "status": "pending", // å¾…ç½‘çº¢ç¡®è®¤
    "new_booking_details": {
      "booking_date": "2024-01-28",
      "booking_time": "14:00-18:00"
    },
    "additional_fee": 0.00 // é¢å¤–è´¹ç”¨
  }
}
```

## 8. æ”¯ä»˜æ¥å£

### 8.1 åˆ›å»ºæ”¯ä»˜è®¢å•

**æ¥å£åœ°å€**: `POST /api/v1/payments/create`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| booking_id | string | æ˜¯ | é¢„è®¢å•å· | "YL202401250001" |
| payment_method | string | æ˜¯ | æ”¯ä»˜æ–¹å¼ï¼šwechat_pay-å¾®ä¿¡æ”¯ä»˜ï¼Œalipay-æ”¯ä»˜å®ï¼Œbalance-ä½™é¢æ”¯ä»˜ | "wechat_pay" |
| return_url | string | å¦ | æ”¯ä»˜æˆåŠŸå›è°ƒURL | "https://app.yuelu.com/payment/success" |
| client_type | string | æ˜¯ | å®¢æˆ·ç«¯ç±»å‹ï¼šminiprogram-å°ç¨‹åºï¼Œh5-ç½‘é¡µï¼Œapp-APP | "miniprogram" |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "booking_id": "YL202401250001",
  "payment_method": "wechat_pay",
  "return_url": "https://app.yuelu.com/payment/success",
  "client_type": "miniprogram"
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | æ”¯ä»˜ä¿¡æ¯å¯¹è±¡ |
| data.payment_id | string | æ”¯ä»˜è®¢å•ID |
| data.payment_params | object | æ”¯ä»˜å‚æ•°å¯¹è±¡ï¼ˆæ ¹æ®æ”¯ä»˜æ–¹å¼ä¸åŒè€Œä¸åŒï¼‰ |
| data.payment_params.timeStamp | string | æ—¶é—´æˆ³ï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ |
| data.payment_params.nonceStr | string | éšæœºå­—ç¬¦ä¸²ï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ |
| data.payment_params.package | string | é¢„æ”¯ä»˜äº¤æ˜“ä¼šè¯æ ‡è¯†ï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ |
| data.payment_params.signType | string | ç­¾åç±»å‹ï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ |
| data.payment_params.paySign | string | æ”¯ä»˜ç­¾åï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ |
| data.expires_at | string | æ”¯ä»˜è¿‡æœŸæ—¶é—´ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "æ”¯ä»˜è®¢å•åˆ›å»ºæˆåŠŸ",
  "data": {
    "payment_id": "PAY202401200001",
    "payment_params": {
      "timeStamp": "1640995200",
      "nonceStr": "abc123",
      "package": "prepay_id=wx20240120164500001",
      "signType": "RSA",
      "paySign": "signature"
    },
    "expires_at": "2024-01-20 18:00:00"
  }
}
```

### 8.2 æ”¯ä»˜çŠ¶æ€æŸ¥è¯¢

**æ¥å£åœ°å€**: `GET /api/v1/payments/{payment_id}/status`

**è·¯å¾„å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| payment_id | string | æ˜¯ | æ”¯ä»˜è®¢å•ID | "PAY202401200001" |

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | æ”¯ä»˜çŠ¶æ€å¯¹è±¡ |
| data.payment_id | string | æ”¯ä»˜è®¢å•ID |
| data.booking_id | string | é¢„è®¢å•å· |
| data.status | string | æ”¯ä»˜çŠ¶æ€ï¼špending-å¾…æ”¯ä»˜ï¼Œpaid-å·²æ”¯ä»˜ï¼Œfailed-æ”¯ä»˜å¤±è´¥ï¼Œcancelled-å·²å–æ¶ˆ |
| data.amount | number | æ”¯ä»˜é‡‘é¢ï¼ˆå…ƒï¼‰ |
| data.payment_method | string | æ”¯ä»˜æ–¹å¼ |
| data.transaction_id | string | ç¬¬ä¸‰æ–¹äº¤æ˜“æµæ°´å· |
| data.paid_at | string | æ”¯ä»˜å®Œæˆæ—¶é—´ |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "payment_id": "PAY202401200001",
    "booking_id": "YL202401250001",
    "status": "paid",
    "amount": 1098.00,
    "payment_method": "wechat_pay",
    "transaction_id": "wx20240120164500001",
    "paid_at": "2024-01-20 16:45:00"
  }
}
```

## 9. è¯„ä»·ç³»ç»Ÿæ¥å£

### 9.1 æäº¤è¯„ä»·

**æ¥å£åœ°å€**: `POST /api/v1/reviews`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| booking_id | string | æ˜¯ | é¢„è®¢å•å· | "YL202401250001" |
| celebrity_id | integer | æ˜¯ | ç½‘çº¢ID | 2001 |
| service_id | integer | æ˜¯ | æœåŠ¡é¡¹ç›®ID | 3001 |
| rating | integer | æ˜¯ | è¯„åˆ†ï¼Œ1-5æ˜Ÿ | 5 |
| content | string | æ˜¯ | è¯„ä»·å†…å®¹ï¼Œ10-500å­—ç¬¦ | "éå¸¸æ£’çš„ä½“éªŒï¼Œç½‘çº¢å¾ˆä¸“ä¸šï¼Œæ¨èçš„ç¾é£Ÿéƒ½å¾ˆå¥½åƒï¼" |
| images | array | å¦ | è¯„ä»·å›¾ç‰‡URLåˆ—è¡¨ï¼Œæœ€å¤š9å¼  | ["https://cdn.yuelu.com/review/upload/1.jpg"] |
| tags | array | å¦ | è¯„ä»·æ ‡ç­¾åˆ—è¡¨ | ["ä¸“ä¸š", "çƒ­æƒ…", "å‡†æ—¶"] |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
{
  "booking_id": "YL202401250001",
  "celebrity_id": 2001,
  "service_id": 3001,
  "rating": 5,
  "content": "éå¸¸æ£’çš„ä½“éªŒï¼Œç½‘çº¢å¾ˆä¸“ä¸šï¼Œæ¨èçš„ç¾é£Ÿéƒ½å¾ˆå¥½åƒï¼",
  "images": [
    "https://cdn.yuelu.com/review/upload/1.jpg",
    "https://cdn.yuelu.com/review/upload/2.jpg"
  ],
  "tags": ["ä¸“ä¸š", "çƒ­æƒ…", "å‡†æ—¶"]
}
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | è¯„ä»·ç»“æœå¯¹è±¡ |
| data.review_id | integer | è¯„ä»·ID |
| data.points_earned | integer | è·å¾—çš„ç§¯åˆ† |

**å“åº”ç¤ºä¾‹**:
```javascript
{
  "code": 200,
  "message": "è¯„ä»·æäº¤æˆåŠŸ",
  "data": {
    "review_id": 4001,
    "points_earned": 50
  }
}
```

### 9.2 è¯„ä»·åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/v1/reviews`

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| celebrity_id | integer | å¦ | ç½‘çº¢IDï¼ŒæŒ‰ç½‘çº¢ç­›é€‰ | 2001 |
| service_id | integer | å¦ | æœåŠ¡é¡¹ç›®IDï¼ŒæŒ‰æœåŠ¡ç­›é€‰ | 3001 |
| rating | integer | å¦ | è¯„åˆ†ç­›é€‰ï¼Œ1-5æ˜Ÿ | 5 |
| page | integer | å¦ | é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤1 | 1 |
| page_size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 | 20 |

**è¯·æ±‚ç¤ºä¾‹**:
```javascript
GET /api/v1/reviews?celebrity_id=2001&service_id=3001&rating=5&page=1&page_size=20
```

**å“åº”å‚æ•°**:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| code | integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | string | å“åº”æ¶ˆæ¯ |
| data | object | å“åº”æ•°æ® |
| data.list | array | è¯„ä»·åˆ—è¡¨ |
| data.list[].id | integer | è¯„ä»·ID |
| data.list[].user_info | object | ç”¨æˆ·ä¿¡æ¯å¯¹è±¡ |
| data.list[].user_info.nickname | string | ç”¨æˆ·æ˜µç§° |
| data.list[].user_info.avatar | string | ç”¨æˆ·å¤´åƒ |
| data.list[].user_info.level | integer | ç”¨æˆ·ç­‰çº§ |
| data.list[].celebrity_info | object | ç½‘çº¢ä¿¡æ¯å¯¹è±¡ |
| data.list[].celebrity_info.id | integer | ç½‘çº¢ID |
| data.list[].celebrity_info.nickname | string | ç½‘çº¢æ˜µç§° |
| data.list[].service_info | object | æœåŠ¡ä¿¡æ¯å¯¹è±¡ |
| data.list[].service_info.id | integer | æœåŠ¡ID |
| data.list[].service_info.name | string | æœåŠ¡åç§° |
| data.list[].rating | integer | è¯„åˆ†ï¼ˆ1-5æ˜Ÿï¼‰ |
| data.list[].content | string | è¯„ä»·å†…å®¹ |
| data.list[].images | array | è¯„ä»·å›¾ç‰‡URLåˆ—è¡¨ |
| data.list[].tags | array | è¯„ä»·æ ‡ç­¾åˆ—è¡¨ |
| data.list[].created_at | string | è¯„ä»·æ—¶é—´ |
| data.list[].helpful_count | integer | æœ‰ç”¨æ•° |
| data.pagination | object | åˆ†é¡µä¿¡æ¯ |
| data.statistics | object | è¯„ä»·ç»Ÿè®¡ä¿¡æ¯ |
| data.statistics.average_rating | number | å¹³å‡è¯„åˆ† |
| data.statistics.rating_distribution | object | è¯„åˆ†åˆ†å¸ƒï¼Œkeyä¸ºè¯„åˆ†ï¼Œvalueä¸ºæ•°é‡ |

## 10. æ¶ˆæ¯é€šçŸ¥æ¥å£

### 10.1 æ¶ˆæ¯åˆ—è¡¨
```javascript
GET /api/v1/notifications

// è¯·æ±‚å‚æ•°
{
  "type": "all", // allã€bookingã€paymentã€system
  "status": "all", // allã€unreadã€read
  "page": 1,
  "page_size": 20
}

// å“åº”
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [
      {
        "id": 6001,
        "type": "booking",
        "title": "é¢„è®¢ç¡®è®¤é€šçŸ¥",
        "content": "æ‚¨çš„é¢„è®¢"ç¾é£Ÿæ¢åº—åŠæ—¥æ¸¸"å·²è¢«ç½‘çº¢ç¡®è®¤",
        "data": { // é™„åŠ æ•°æ®
          "booking_id": "YL202401250001",
          "action": "view_booking"
        },
        "is_read": false,
        "created_at": "2024-01-20 17:20:00"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 25,
      "total_pages": 2
    },
    "unread_count": 5 // æœªè¯»æ•°é‡
  }
}
```

### 10.2 æ ‡è®°å·²è¯»
```javascript
POST /api/v1/notifications/mark-read

// è¯·æ±‚å‚æ•°
{
  "notification_ids": [6001, 6002], // æ¶ˆæ¯IDæ•°ç»„ï¼Œç©ºæ•°ç»„è¡¨ç¤ºå…¨éƒ¨æ ‡è®°å·²è¯»
}

// å“åº”
{
  "code": 200,
  "message": "æ ‡è®°æˆåŠŸ",
  "data": {
    "marked_count": 2
  }
}
```

## 11. æ•°æ®ç»Ÿè®¡æ¥å£

### 11.1 é¦–é¡µç»Ÿè®¡æ•°æ®
```javascript
GET /api/v1/statistics/dashboard

// å“åº”
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "user_stats": {
      "total_bookings": 15, // æ€»é¢„è®¢æ•°
      "completed_bookings": 12, // å·²å®Œæˆé¢„è®¢
      "total_spent": 8500.00, // æ€»æ¶ˆè´¹é‡‘é¢
      "points_balance": 1500, // ç§¯åˆ†ä½™é¢
      "level": 2, // ç”¨æˆ·ç­‰çº§
      "next_level_points": 500 // å‡çº§æ‰€éœ€ç§¯åˆ†
    },
    "recent_bookings": [ // æœ€è¿‘é¢„è®¢
      {
        "booking_id": "YL202401250001",
        "celebrity_name": "åŒ—äº¬ç¾é£Ÿè¾¾äºº",
        "service_name": "ç¾é£Ÿæ¢åº—åŠæ—¥æ¸¸",
        "booking_date": "2024-01-25",
        "status": "confirmed"
      }
    ],
    "recommended_celebrities": [ // æ¨èç½‘çº¢
      {
        "id": 2002,
        "nickname": "ä¸Šæµ·è´­ç‰©è¾¾äºº",
        "avatar": "https://cdn.yuelu.com/celebrity/2002.jpg",
        "rating": 4.9,
        "price_per_hour": 399
      }
    ]
  }
}
```

## 12. é”™è¯¯ç è¯´æ˜

### 12.1 é€šç”¨é”™è¯¯ç 
```javascript
{
  // æˆåŠŸ
  200: "æ“ä½œæˆåŠŸ",
  
  // å®¢æˆ·ç«¯é”™è¯¯ 4xx
  400: "è¯·æ±‚å‚æ•°é”™è¯¯",
  401: "æœªæˆæƒï¼Œè¯·å…ˆç™»å½•",
  403: "æƒé™ä¸è¶³",
  404: "èµ„æºä¸å­˜åœ¨",
  409: "èµ„æºå†²çª",
  422: "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥",
  429: "è¯·æ±‚è¿‡äºé¢‘ç¹",
  
  // æœåŠ¡å™¨é”™è¯¯ 5xx
  500: "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯",
  502: "ç½‘å…³é”™è¯¯",
  503: "æœåŠ¡æš‚ä¸å¯ç”¨",
  504: "ç½‘å…³è¶…æ—¶"
}
```

### 12.2 ä¸šåŠ¡é”™è¯¯ç 
```javascript
{
  // ç”¨æˆ·ç›¸å…³ 1xxx
  1001: "æ‰‹æœºå·å·²æ³¨å†Œ",
  1002: "éªŒè¯ç é”™è¯¯",
  1003: "å¯†ç é”™è¯¯",
  1004: "è´¦å·å·²è¢«ç¦ç”¨",
  
  // ç½‘çº¢ç›¸å…³ 2xxx
  2001: "ç½‘çº¢ä¸å­˜åœ¨",
  2002: "ç½‘çº¢å·²ä¸‹çº¿",
  2003: "ç½‘çº¢æœåŠ¡ä¸å¯ç”¨",
  
  // é¢„è®¢ç›¸å…³ 3xxx
  3001: "é¢„è®¢æ—¶é—´ä¸å¯ç”¨",
  3002: "é¢„è®¢äººæ•°è¶…é™",
  3003: "é¢„è®¢å·²å–æ¶ˆ",
  3004: "é¢„è®¢ä¸å¯ä¿®æ”¹",
  
  // æ”¯ä»˜ç›¸å…³ 4xxx
  4001: "æ”¯ä»˜å¤±è´¥",
  4002: "ä½™é¢ä¸è¶³",
  4003: "æ”¯ä»˜å·²è¿‡æœŸ",
  4004: "é‡å¤æ”¯ä»˜",
  
  // è¯„ä»·ç›¸å…³ 5xxx
  5001: "å·²è¯„ä»·è¿‡",
  5002: "è¯„ä»·å†…å®¹è¿è§„",
  5003: "è¯„ä»·æ—¶é—´å·²è¿‡æœŸ"
}
```

## 13. æ¥å£è°ƒç”¨ç¤ºä¾‹

### 13.1 JavaScriptç¤ºä¾‹
```javascript
// å°è£…APIè¯·æ±‚ç±»
class YueluAPI {
  constructor(baseURL = 'https://api.yuelu.com') {
    this.baseURL = baseURL;
    this.token = localStorage.getItem('access_token');
  }
  
  // è®¾ç½®Token
  setToken(token) {
    this.token = token;
    localStorage.setItem('access_token', token);
  }
  
  // é€šç”¨è¯·æ±‚æ–¹æ³•
  async request(method, url, data = null) {
    const config = {
      method,
      headers: {
        'Content-Type': 'application/json',
      }
    };
    
    // æ·»åŠ è®¤è¯å¤´
    if (this.token) {
      config.headers.Authorization = `Bearer ${this.token}`;
    }
    
    // æ·»åŠ è¯·æ±‚ä½“
    if (data && (method === 'POST' || method === 'PUT')) {
      config.body = JSON.stringify(data);
    }
    
    try {
      const response = await fetch(`${this.baseURL}${url}`, config);
      const result = await response.json();
      
      if (result.code === 200) {
        return result.data;
      } else {
        throw new Error(result.message);
      }
    } catch (error) {
      console.error('APIè¯·æ±‚å¤±è´¥:', error);
      throw error;
    }
  }
  
  // ç”¨æˆ·ç™»å½•
  async login(phone, password, type = 'user') {
    const data = await this.request('POST', '/api/v1/auth/login', {
      phone, password, type
    });
    this.setToken(data.access_token);
    return data;
  }
  
  // è·å–ç½‘çº¢åˆ—è¡¨
  async getCelebrities(params = {}) {
    const query = new URLSearchParams(params).toString();
    return this.request('GET', `/api/v1/celebrities?${query}`);
  }
  
  // åˆ›å»ºé¢„è®¢
  async createBooking(bookingData) {
    return this.request('POST', '/api/v1/bookings', bookingData);
  }
  
  // è·å–é¢„è®¢åˆ—è¡¨
  async getBookings(params = {}) {
    const query = new URLSearchParams(params).toString();
    return this.request('GET', `/api/v1/bookings?${query}`);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const api = new YueluAPI();

// ç™»å½•
try {
  const loginResult = await api.login('13800138000', '123456');
  console.log('ç™»å½•æˆåŠŸ:', loginResult);
} catch (error) {
  console.error('ç™»å½•å¤±è´¥:', error.message);
}

// è·å–ç½‘çº¢åˆ—è¡¨
try {
  const celebrities = await api.getCelebrities({
    city: 'åŒ—äº¬å¸‚',
    category: 'ç¾é£Ÿ',
    page: 1,
    page_size: 10
  });
  console.log('ç½‘çº¢åˆ—è¡¨:', celebrities);
} catch (error) {
  console.error('è·å–å¤±è´¥:', error.message);
}
```

### 13.2 å¾®ä¿¡å°ç¨‹åºç¤ºä¾‹
```javascript
// å¾®ä¿¡å°ç¨‹åºAPIå°è£…
class WxYueluAPI {
  constructor() {
    this.baseURL = 'https://api.yuelu.com';
    this.token = wx.getStorageSync('access_token');
  }
  
  // é€šç”¨è¯·æ±‚æ–¹æ³•
  request(options) {
    return new Promise((resolve, reject) => {
      wx.request({
        url: `${this.baseURL}${options.url}`,
        method: options.method || 'GET',
        data: options.data || {},
        header: {
          'Content-Type': 'application/json',
          'Authorization': this.token ? `Bearer ${this.token}` : ''
        },
        success: (res) => {
          if (res.data.code === 200) {
            resolve(res.data.data);
          } else {
            wx.showToast({
              title: res.data.message,
              icon: 'none'
            });
            reject(new Error(res.data.message));
          }
        },
        fail: (error) => {
          wx.showToast({
            title: 'ç½‘ç»œè¯·æ±‚å¤±è´¥',
            icon: 'none'
          });
          reject(error);
        }
      });
    });
  }
  
  // å¾®ä¿¡ç™»å½•
  async wxLogin() {
    try {
      // è·å–å¾®ä¿¡ç™»å½•code
      const loginRes = await new Promise((resolve, reject) => {
        wx.login({
          success: resolve,
          fail: reject
        });
      });
      
      // å‘é€codeåˆ°åç«¯
      const data = await this.request({
        url: '/api/v1/auth/wx-login',
        method: 'POST',
        data: {
          code: loginRes.code
        }
      });
      
      // ä¿å­˜token
      this.token = data.access_token;
      wx.setStorageSync('access_token', this.token);
      
      return data;
    } catch (error) {
      console.error('å¾®ä¿¡ç™»å½•å¤±è´¥:', error);
      throw error;
    }
  }
  
  // å¾®ä¿¡æ”¯ä»˜
  async wxPay(bookingId) {
    try {
      // åˆ›å»ºæ”¯ä»˜è®¢å•
      const paymentData = await this.request({
        url: '/api/v1/payments/create',
        method: 'POST',
        data: {
          booking_id: bookingId,
          payment_method: 'wechat_pay',
          client_type: 'miniprogram'
        }
      });
      
      // è°ƒèµ·å¾®ä¿¡æ”¯ä»˜
      await new Promise((resolve, reject) => {
        wx.requestPayment({
          ...paymentData.payment_params,
          success: resolve,
          fail: reject
        });
      });
      
      return { success: true };
    } catch (error) {
      console.error('æ”¯ä»˜å¤±è´¥:', error);
      throw error;
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const wxApi = new WxYueluAPI();

// é¡µé¢ä¸­ä½¿ç”¨
Page({
  data: {
    celebrities: []
  },
  
  async onLoad() {
    try {
      // å¾®ä¿¡ç™»å½•
      await wxApi.wxLogin();
      
      // è·å–ç½‘çº¢åˆ—è¡¨
      const celebrities = await wxApi.request({
        url: '/api/v1/celebrities',
        data: {
          city: 'åŒ—äº¬å¸‚',
          page: 1,
          page_size: 10
        }
      });
      
      this.setData({
        celebrities: celebrities.list
      });
    } catch (error) {
      console.error('åˆå§‹åŒ–å¤±è´¥:', error);
    }
  },
  
  // é¢„è®¢æœåŠ¡
  async bookService(e) {
    const { celebrityId, serviceId } = e.currentTarget.dataset;
    
    try {
      const booking = await wxApi.request({
        url: '/api/v1/bookings',
        method: 'POST',
        data: {
          celebrity_id: celebrityId,
          service_id: serviceId,
          booking_date: '2024-01-25',
          booking_time: '09:00-13:00',
          people_count: 2,
          contact_name: 'å¼ ä¸‰',
          contact_phone: '13800138000'
        }
      });
      
      // è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
      wx.navigateTo({
        url: `/pages/payment/payment?bookingId=${booking.booking_id}`
      });
    } catch (error) {
      console.error('é¢„è®¢å¤±è´¥:', error);
    }
  }
});
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v1.0 | 2024-01-01 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«æ ¸å¿ƒAPIæ¥å£ |

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰æ¥å£å¯¹æ¥é—®é¢˜ï¼Œè¯·è”ç³»ï¼š
- **æŠ€æœ¯æ”¯æŒé‚®ç®±**: tech@yuelu.com
- **å¼€å‘è€…QQç¾¤**: 123456789
- **æŠ€æœ¯æ–‡æ¡£**: https://docs.yuelu.com

---

**é‡è¦æé†’**: 
1. æ‰€æœ‰æ¥å£éƒ½éœ€è¦HTTPSåè®®è®¿é—®
2. è¯·å¦¥å–„ä¿ç®¡access_tokenï¼Œé¿å…æ³„éœ²
3. å»ºè®®å®ç°tokenè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
4. ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨æ­£å¼åŸŸåå’Œè¯ä¹¦ 